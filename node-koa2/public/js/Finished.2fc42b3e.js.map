{"version":3,"sources":["webpack:///./src/views/Finished/index.jsx","webpack:///./src/api/todo.ts","webpack:///./src/views/Finished/index.module.less?0fe0"],"names":["name","data","currentPage","pageSize","total","todoData","loading","methods","getFinishedTodoList","page","ApiGetFinishedTodoList","resp","code","result","list","pagination","forEach","item","key","$moment","date","format","undefined","push","handleGoDetail","this","$router","query","id","handleDelete","ApiDeleteTodoToRecycle","$toast","success","message","mounted","render","$data","$route","meta","title","styles","wrapper","Object","keys","map","titleBar","paddingTop","paddingBottom","ApiSaveTodoList","post","ApiGetTodoDate","get","ApiGetTodoList","ApiGetTodoDetail","ApiGetTodoListByDay","day","ApiGetReviewTodoList","ApiGetRecycleTodoList","ApiDeleteTodo","delete","ApiRestoreTodoFromRecycle","put","ApiToggleFinishTodo","status","module","exports"],"mappings":"sNAGe,cACbA,KAAM,WACNC,KAFa,WAGX,MAAO,CACLC,YAAa,EACbC,SAAU,GACVC,MAAO,EACPC,SAAU,GACVC,SAAS,IAGbC,QAAS,CACDC,oBADC,WAC4C,2LAAzBC,EAAyB,+BAAlB,EAAGN,EAAe,+BAAJ,IACzC,EAAKG,QADwC,wDAEjD,EAAKA,SAAU,EACf,EAAKJ,YAAcO,EACnB,EAAKN,SAAWA,EACVF,EAAO,CACXQ,OACAN,YAP+C,UAS9BO,eAAuBT,GATO,QAS3CU,EAT2C,OAUjD,EAAKL,SAAU,EACG,IAAdK,EAAKC,OAAY,EACUD,EAAKE,OAA1BC,EADW,EACXA,KAAMC,EADK,EACLA,WACNX,EAAUW,EAAVX,MACRU,EAAKE,SAAQ,SAAAC,GACX,IAAMC,EAAM,EAAKC,QAAQF,EAAKG,MAAMC,OAAO,mBAChBC,IAAvB,EAAKjB,SAASa,KAChB,EAAKb,SAASa,GAAO,IAEvB,EAAKb,SAASa,GAAKK,KAAKN,MAE1B,EAAKb,MAAQA,GArBkC,+CAwBnDoB,eAzBO,SAyBQP,GACbQ,KAAKC,QAAQH,KAAK,CAChBvB,KAAM,aACN2B,MAAO,CACLC,GAAIX,EAAKW,OAITC,aAjCC,SAiCYZ,GAAM,uKACfW,EAAOX,EAAPW,GADe,SAEJE,eAAuBF,GAFnB,OAEjBjB,EAFiB,OAGL,IAAdA,EAAKC,MACP,EAAKmB,OAAOC,QAAQrB,EAAKsB,SAJJ,+CAQ3BC,QApDa,WAqDXT,KAAKjB,uBAEP2B,OAvDa,WAuDJ,4BACuBV,KAAKW,MAA3B/B,EADD,EACCA,SAAUC,EADX,EACWA,QAElB,iDAEoBmB,KAAKY,OAAOC,KAAKC,MAFrC,KAEiD,UAFjD,gCAIqBC,IAAOC,SAJ5B,CAKOC,OAAOC,KAAKtC,GAAUuC,KAAI,SAAAxB,GAAI,+BAEfoB,IAAOK,UAFQ,wBAGN,WAHM,CAGKzB,MAHL,4CAOhBd,EAPgB,SAQfD,EAASe,IARM,aASb,EAAKI,eATQ,IAUlB,EAAKK,cAVa,MAWlB,CACLiB,WAAY,EACZC,cAAe,iB,oCC/EjC,waAmBM,SAAUC,EAAgB/C,GAC9B,OAAO,OAAQgD,KAAK,qBAAsBhD,GAMtC,SAAUiD,IACd,OAAO,OAAQC,IAAI,yBASf,SAAUC,EAAenD,GAC7B,OAAO,OAAQkD,IAAI,oBAAqBlD,GAOpC,SAAUoD,EAAiBzB,GAC/B,OAAO,OAAQuB,IAAR,8BAAmCvB,IAOtC,SAAU0B,EAAoBC,GAClC,OAAO,OAAQJ,IAAI,yBAA0B,CAC3CI,QAOE,SAAUC,IACd,OAAO,OAAQL,IAAI,2BASf,SAAUzC,EAAuBT,GACrC,OAAO,OAAQkD,IAAI,4BAA6BlD,GAS5C,SAAUwD,EAAsBxD,GACpC,OAAO,OAAQkD,IAAI,2BAA4BlD,GAO3C,SAAUyD,EAAc9B,GAC5B,OAAO,OAAQ+B,OAAR,+BAAuC/B,IAO1C,SAAUE,EAAuBF,GACrC,OAAO,OAAQ+B,OAAR,oCAA4C/B,IAO/C,SAAUgC,EAA0BhC,GACxC,OAAO,OAAQiC,IAAR,qCAA0CjC,IAO7C,SAAUkC,EAAoBlC,EAAImC,GACtC,OAAO,OAAQF,IAAR,uBAAoC,CACzCjC,KACAmC,a,qBCnHJC,EAAOC,QAAU,CAAC,QAAU,6BAA6B,SAAW","file":"js/Finished.2fc42b3e.js","sourcesContent":["import styles from \"./index.module.less\";\r\nimport { ApiGetFinishedTodoList, ApiDeleteTodoToRecycle } from \"@/api/todo\";\r\n\r\nexport default {\r\n  name: \"Finished\",\r\n  data() {\r\n    return {\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      todoData: [],\r\n      loading: false\r\n    };\r\n  },\r\n  methods: {\r\n    async getFinishedTodoList(page = 1, pageSize = 10) {\r\n      if (this.loading) return;\r\n      this.loading = true;\r\n      this.currentPage = page;\r\n      this.pageSize = pageSize;\r\n      const data = {\r\n        page,\r\n        pageSize\r\n      };\r\n      const resp = await ApiGetFinishedTodoList(data);\r\n      this.loading = false;\r\n      if (resp.code === 0) {\r\n        const { list, pagination } = resp.result;\r\n        const { total } = pagination;\r\n        list.forEach(item => {\r\n          const key = this.$moment(item.date).format(\"YYYY-MM-DD\");\r\n          if (this.todoData[key] === undefined) {\r\n            this.todoData[key] = [];\r\n          }\r\n          this.todoData[key].push(item);\r\n        });\r\n        this.total = total;\r\n      }\r\n    },\r\n    handleGoDetail(item) {\r\n      this.$router.push({\r\n        name: \"TodoDetail\",\r\n        query: {\r\n          id: item.id\r\n        }\r\n      });\r\n    },\r\n    async handleDelete(item) {\r\n      const { id } = item;\r\n      const resp = await ApiDeleteTodoToRecycle(id);\r\n      if (resp.code === 0) {\r\n        this.$toast.success(resp.message);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getFinishedTodoList();\r\n  },\r\n  render() {\r\n    const { todoData, loading } = this.$data;\r\n\r\n    return (\r\n      <EContainer>\r\n        <EHeader title={this.$route.meta.title} type=\"menu\" />\r\n        <EAside />\r\n        <EContent class={styles.wrapper}>\r\n          {Object.keys(todoData).map(date => (\r\n            <div>\r\n              <div class={styles.titleBar}>\r\n                <van-divider class=\"divider\">{date}</van-divider>\r\n              </div>\r\n              <ETodoCard\r\n                isReadonly\r\n                loading={loading}\r\n                todoList={todoData[date]}\r\n                onGoDetail={this.handleGoDetail}\r\n                onDel={this.handleDelete}\r\n                style={{\r\n                  paddingTop: 0,\r\n                  paddingBottom: 0\r\n                }}\r\n              />\r\n            </div>\r\n          ))}\r\n        </EContent>\r\n      </EContainer>\r\n    );\r\n  }\r\n};\r\n","import service from \"@/axios/service\";\r\n\r\ntype TodoData = {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  date: Date;\r\n  priority: number;\r\n};\r\n\r\n/**\r\n * 新增/编辑待办\r\n * @param {Object} data\r\n * @param {Number} data.id\r\n * @param {Number} data.title\r\n * @param {String} data.description\r\n * @param {timestamp} data.date\r\n * @param {Number} data.priority\r\n */\r\nexport function ApiSaveTodoList(data: TodoData) {\r\n  return service.post(\"/api/todo/saveList\", data);\r\n}\r\n\r\n/**\r\n * 获取日程\r\n */\r\nexport function ApiGetTodoDate() {\r\n  return service.get(\"/api/todo/getDateList\");\r\n}\r\n\r\n/**\r\n * 获取待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetTodoList(data) {\r\n  return service.get(\"/api/todo/getList\", data);\r\n}\r\n\r\n/**\r\n * 获取待办详情\r\n * @param {String} id\r\n */\r\nexport function ApiGetTodoDetail(id) {\r\n  return service.get(`/api/todo/getDetail/${id}`);\r\n}\r\n\r\n/**\r\n * 根据日期获取待办数据\r\n * @param {timestamp} day\r\n */\r\nexport function ApiGetTodoListByDay(day) {\r\n  return service.get(\"/api/todo/getListByDay\", {\r\n    day\r\n  });\r\n}\r\n\r\n/**\r\n * 获取本周事件回顾\r\n */\r\nexport function ApiGetReviewTodoList() {\r\n  return service.get(\"/api/todo/getReviewList\");\r\n}\r\n\r\n/**\r\n * 获取已完成待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetFinishedTodoList(data) {\r\n  return service.get(\"/api/todo/getFinishedList\", data);\r\n}\r\n\r\n/**\r\n * 获取回收站待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetRecycleTodoList(data) {\r\n  return service.get(\"/api/todo/getRecycleList\", data);\r\n}\r\n\r\n/**\r\n * 删除待办\r\n * @param {String} id\r\n */\r\nexport function ApiDeleteTodo(id) {\r\n  return service.delete(`/api/todo/deleteTodo/${id}`);\r\n}\r\n\r\n/**\r\n * 删除待办-回收站\r\n * @param {String} id\r\n */\r\nexport function ApiDeleteTodoToRecycle(id) {\r\n  return service.delete(`/api/todo/deleteToRecycle/${id}`);\r\n}\r\n\r\n/**\r\n * 还原待办-回收站\r\n * @param {String} id\r\n */\r\nexport function ApiRestoreTodoFromRecycle(id) {\r\n  return service.put(`/api/todo/restoreToRecycle/${id}`);\r\n}\r\n\r\n/**\r\n * 切换完成状态\r\n * @param {String} id\r\n */\r\nexport function ApiToggleFinishTodo(id, status) {\r\n  return service.put(`/api/todo/finishTodo`, {\r\n    id,\r\n    status\r\n  });\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"index-module_wrapper_36Pwh\",\"titleBar\":\"index-module_titleBar_kMBmp\"};"],"sourceRoot":""}