{"version":3,"sources":["webpack:///./src/views/TodoDetail/index.module.less?21b7","webpack:///./src/api/todo.ts","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/utils/constant.ts","webpack:///./src/views/TodoDetail/index.jsx"],"names":["module","exports","ApiSaveTodoList","data","post","ApiGetTodoDate","get","ApiGetTodoList","ApiGetTodoDetail","id","ApiGetTodoListByDay","day","ApiGetReviewTodoList","ApiGetFinishedTodoList","ApiGetRecycleTodoList","ApiDeleteTodo","delete","ApiDeleteTodoToRecycle","ApiRestoreTodoFromRecycle","put","ApiToggleFinishTodo","status","$","$find","find","addToUnscopables","arrayMethodUsesToLength","FIND","SKIPS_HOLES","USES_TO_LENGTH","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","priorityOption","name","key","color","statusVisible","statusData","currentDate","Date","visibleDate","todoData","title","description","date","priority","methods","getTodoDetail","loading","resp","code","result","item","handleOpenDate","handleCloseDate","handleConfirmDate","value","$moment","handleOpenStatus","handleCloseStatus","handleSelectStatus","handleSave","$toast","success","setTimeout","$router","replace","mounted","$route","query","render","$data","classNames","styles","todoDetail","saveBtn","todoDetailContent","todoDetailHeader","todoDetailHeaderItem","todoDetailClaim","icon","calendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","todoDetailTitle","finished","todoDetailCheck","todoDetailInput","paddingLeft","textarea"],"mappings":"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","file":"js/TodoDetail.f20047ec.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"todoDetail\":\"index-module_todoDetail_3Pv6Z\",\"saveBtn\":\"index-module_saveBtn_3uifg\",\"todoDetailContent\":\"index-module_todoDetailContent_19ElI\",\"todoDetailHeader\":\"index-module_todoDetailHeader_3T4SK\",\"todoDetailHeaderItem\":\"index-module_todoDetailHeaderItem_1A7qb\",\"todoDetailTitle\":\"index-module_todoDetailTitle_3Dkca\",\"finished\":\"index-module_finished_2LOol\",\"todoDetailCheck\":\"index-module_todoDetailCheck_2_5WC\",\"icon\":\"index-module_icon_1M2mh\",\"todoDetailInput\":\"index-module_todoDetailInput_QFrdb\",\"textarea\":\"index-module_textarea_3LyXP\",\"todoDetailClaim\":\"index-module_todoDetailClaim_2X9ky\"};","import service from \"@/axios/service\";\r\n\r\ntype TodoData = {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  date: Date;\r\n  priority: number;\r\n};\r\n\r\n/**\r\n * 新增/编辑待办\r\n * @param {Object} data\r\n * @param {Number} data.id\r\n * @param {Number} data.title\r\n * @param {String} data.description\r\n * @param {timestamp} data.date\r\n * @param {Number} data.priority\r\n */\r\nexport function ApiSaveTodoList(data: TodoData) {\r\n  return service.post(\"/api/todo/saveList\", data);\r\n}\r\n\r\n/**\r\n * 获取日程\r\n */\r\nexport function ApiGetTodoDate() {\r\n  return service.get(\"/api/todo/getDateList\");\r\n}\r\n\r\n/**\r\n * 获取待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetTodoList(data) {\r\n  return service.get(\"/api/todo/getList\", data);\r\n}\r\n\r\n/**\r\n * 获取待办详情\r\n * @param {String} id\r\n */\r\nexport function ApiGetTodoDetail(id) {\r\n  return service.get(`/api/todo/getDetail/${id}`);\r\n}\r\n\r\n/**\r\n * 根据日期获取待办数据\r\n * @param {timestamp} day\r\n */\r\nexport function ApiGetTodoListByDay(day) {\r\n  return service.get(\"/api/todo/getListByDay\", {\r\n    day\r\n  });\r\n}\r\n\r\n/**\r\n * 获取本周事件回顾\r\n */\r\nexport function ApiGetReviewTodoList() {\r\n  return service.get(\"/api/todo/getReviewList\");\r\n}\r\n\r\n/**\r\n * 获取已完成待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetFinishedTodoList(data) {\r\n  return service.get(\"/api/todo/getFinishedList\", data);\r\n}\r\n\r\n/**\r\n * 获取回收站待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetRecycleTodoList(data) {\r\n  return service.get(\"/api/todo/getRecycleList\", data);\r\n}\r\n\r\n/**\r\n * 删除待办\r\n * @param {String} id\r\n */\r\nexport function ApiDeleteTodo(id) {\r\n  return service.delete(`/api/todo/deleteTodo/${id}`);\r\n}\r\n\r\n/**\r\n * 删除待办-回收站\r\n * @param {String} id\r\n */\r\nexport function ApiDeleteTodoToRecycle(id) {\r\n  return service.delete(`/api/todo/deleteToRecycle/${id}`);\r\n}\r\n\r\n/**\r\n * 还原待办-回收站\r\n * @param {String} id\r\n */\r\nexport function ApiRestoreTodoFromRecycle(id) {\r\n  return service.put(`/api/todo/restoreToRecycle/${id}`);\r\n}\r\n\r\n/**\r\n * 切换完成状态\r\n * @param {String} id\r\n */\r\nexport function ApiToggleFinishTodo(id, status) {\r\n  return service.put(`/api/todo/finishTodo`, {\r\n    id,\r\n    status\r\n  });\r\n}\r\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","export const priorityOption = [\r\n  {\r\n    name: \"低优先级\",\r\n    key: 1,\r\n    color: \"#1890ff\"\r\n  },\r\n  {\r\n    name: \"中优先级\",\r\n    key: 2,\r\n    color: \"#52c41a\"\r\n  },\r\n  {\r\n    name: \"高优先级\",\r\n    key: 3,\r\n    color: \"#faad14\"\r\n  },\r\n  {\r\n    name: \"最高优先级\",\r\n    key: 4,\r\n    color: \"#f5222d\"\r\n  }\r\n];\r\n","import styles from \"./index.module.less\";\r\nimport classNames from \"classnames\";\r\nimport { ApiGetTodoDetail, ApiSaveTodoList } from \"@/api/todo\";\r\nimport { priorityOption } from \"@/utils/constant\";\r\n\r\nexport default {\r\n  name: \"TodoDetail\",\r\n  data() {\r\n    return {\r\n      id: undefined,\r\n      statusVisible: false,\r\n      statusData: {},\r\n      currentDate: new Date(),\r\n      visibleDate: false,\r\n      todoData: {},\r\n      title: \"\",\r\n      description: \"\",\r\n      date: +new Date(),\r\n      priority: undefined\r\n    };\r\n  },\r\n  methods: {\r\n    async getTodoDetail(id) {\r\n      if (!id) {\r\n        return;\r\n      }\r\n      this.loading = true;\r\n      const resp = await ApiGetTodoDetail(id);\r\n      this.loading = false;\r\n      if (resp.code === 0) {\r\n        const data = resp.result;\r\n        this.todoData = data;\r\n        this.title = data.title;\r\n        this.description = data.description;\r\n        this.date = data.date;\r\n        this.priority = data.priority;\r\n        this.statusData =\r\n          priorityOption.find(item => item.key === data.priority) || {};\r\n      }\r\n    },\r\n    handleOpenDate() {\r\n      this.visibleDate = true;\r\n    },\r\n    handleCloseDate() {\r\n      this.visibleDate = false;\r\n    },\r\n    handleConfirmDate(value) {\r\n      this.date = this.$moment(value);\r\n      this.handleCloseDate();\r\n    },\r\n    handleOpenStatus() {\r\n      this.statusVisible = true;\r\n    },\r\n    handleCloseStatus() {\r\n      this.statusVisible = false;\r\n    },\r\n    handleSelectStatus(value) {\r\n      this.statusData = value;\r\n      this.priority = value.key;\r\n      this.handleCloseStatus();\r\n    },\r\n    async handleSave() {\r\n      if (!this.title) {\r\n        this.$toast(\"请填写标题~\");\r\n        return;\r\n      }\r\n\r\n      const data = {\r\n        title: this.title,\r\n        description: this.description,\r\n        date: this.date,\r\n        priority: this.priority\r\n      };\r\n\r\n      if (this.id) {\r\n        data[\"id\"] = this.id;\r\n      }\r\n      const resp = await ApiSaveTodoList(data);\r\n      if (resp.code === 0) {\r\n        this.$toast.success(\"提交成功\");\r\n        setTimeout(() => {\r\n          this.$router.replace({\r\n            name: \"Todo\"\r\n          });\r\n        }, 1500);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    const { id } = this.$route.query;\r\n    this.id = id;\r\n    this.getTodoDetail(id);\r\n  },\r\n  render() {\r\n    const {\r\n      statusVisible,\r\n      statusData,\r\n      currentDate,\r\n      visibleDate,\r\n      todoData,\r\n      id,\r\n      title,\r\n      description,\r\n      date\r\n    } = this.$data;\r\n\r\n    return (\r\n      <EContainer class={classNames(styles.todoDetail)}>\r\n        <EHeader\r\n          extra={\r\n            <van-button\r\n              plain\r\n              type=\"info\"\r\n              class={styles.saveBtn}\r\n              onClick={this.handleSave}\r\n            >\r\n              保存\r\n            </van-button>\r\n          }\r\n        />\r\n        <EContent>\r\n          <div class={styles.todoDetailContent}>\r\n            <div class={styles.todoDetailHeader}>\r\n              <div\r\n                class={styles.todoDetailHeaderItem}\r\n                onClick={this.handleOpenStatus}\r\n              >\r\n                <span\r\n                  style={{\r\n                    color: statusData.color\r\n                  }}\r\n                >\r\n                  {statusData.name || \"优先级\"}\r\n                </span>\r\n              </div>\r\n              <div class={styles.todoDetailHeaderItem}>\r\n                <div\r\n                  class={styles.todoDetailClaim}\r\n                  onClick={this.handleOpenDate}\r\n                >\r\n                  <i class={classNames(\"iconfont\", styles.icon)}>&#xe668;</i>\r\n                  <span>\r\n                    {this.$moment(date).calendar(undefined, {\r\n                      sameDay: \"[今天]\",\r\n                      nextDay: \"[明天]\",\r\n                      nextWeek: \"MM-DD HH:mm\",\r\n                      lastDay: \"[昨天]\",\r\n                      lastWeek: \"MM-DD HH:mm\",\r\n                      sameElse: \"MM-DD HH:mm\"\r\n                    })}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <van-divider />\r\n            <div\r\n              class={classNames(styles.todoDetailTitle, {\r\n                [styles.finished]: todoData.status === 2\r\n              })}\r\n            >\r\n              {id && (\r\n                <span class={styles.todoDetailCheck}>\r\n                  <i\r\n                    class={classNames(\"iconfont\", styles.icon)}\r\n                    domPropsInnerHTML={\r\n                      todoData.status === 2 ? \"&#xe606;\" : \"&#xe6ca;\"\r\n                    }\r\n                  ></i>\r\n                </span>\r\n              )}\r\n              <van-field\r\n                class={classNames(styles.todoDetailInput)}\r\n                value={title}\r\n                onInput={value => (this.$data.title = value)}\r\n                placeholder=\"标题\"\r\n                style={{\r\n                  paddingLeft: id ? \"\" : 0\r\n                }}\r\n              />\r\n            </div>\r\n            <van-field\r\n              class={classNames(styles.todoDetailInput, styles.textarea)}\r\n              value={description}\r\n              onInput={value => (this.$data.description = value)}\r\n              showWordLimit={true}\r\n              maxlength=\"200\"\r\n              type=\"textarea\"\r\n              rows=\"10\"\r\n              autosize\r\n              placeholder=\"记录你的美好\"\r\n            />\r\n          </div>\r\n        </EContent>\r\n        <van-action-sheet\r\n          value={statusVisible}\r\n          onInput={this.handleCloseStatus}\r\n          actions={priorityOption}\r\n          round={false}\r\n          onSelect={this.handleSelectStatus}\r\n        />\r\n        <van-popup\r\n          value={visibleDate}\r\n          onInput={this.handleCloseDate}\r\n          position=\"bottom\"\r\n        >\r\n          <van-datetime-picker\r\n            onCancel={this.handleCloseDate}\r\n            onConfirm={this.handleConfirmDate}\r\n            value={currentDate}\r\n            type=\"datetime\"\r\n            title=\"选择完整时间\"\r\n          />\r\n        </van-popup>\r\n      </EContainer>\r\n    );\r\n  }\r\n};\r\n"],"sourceRoot":""}