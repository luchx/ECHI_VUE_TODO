{"version":3,"sources":["webpack:///./src/views/Date/index.module.less?d6c5","webpack:///./node_modules/core-js/modules/es.array.some.js","webpack:///./src/api/todo.ts","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/views/Date/index.jsx"],"names":["module","exports","$","$some","some","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","target","proto","forced","callbackfn","this","arguments","length","undefined","ApiSaveTodoList","data","post","ApiGetTodoDate","get","ApiGetTodoList","ApiGetTodoDetail","id","ApiGetTodoListByDay","day","ApiGetReviewTodoList","ApiGetFinishedTodoList","ApiGetRecycleTodoList","ApiDeleteTodo","delete","ApiDeleteTodoToRecycle","ApiRestoreTodoFromRecycle","put","ApiToggleFinishTodo","status","$find","find","addToUnscopables","FIND","SKIPS_HOLES","Array","name","showCalender","weekDate","currentDate","Date","todoList","dateList","loading","methods","formatDate","timeStamp","count","currentDay","$moment","addNum","addDay","push","formatterCalender","item","isTodo","date","isSame","bottomInfo","getTodoListByDay","format","resp","code","result","handleCheck","$toast","success","message","handleGoDetail","$router","query","handleShowCalender","handleCloseCalender","handleConfirmCalender","value","times","handleUpdateValue","handleDelete","filter","todo","getTodoDate","created","$store","dispatch","render","$data","$route","meta","title","styles","calender"],"mappings":"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","file":"js/Date.b77ab158.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"calender\":\"index-module_calender_1-ovm\"};","'use strict';\nvar $ = require('../internals/export');\nvar $some = require('../internals/array-iteration').some;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('some');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('some');\n\n// `Array.prototype.some` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.some\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","import service from \"@/axios/service\";\r\n\r\ntype TodoData = {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  date: Date;\r\n  priority: number;\r\n};\r\n\r\n/**\r\n * 新增/编辑待办\r\n * @param {Object} data\r\n * @param {Number} data.id\r\n * @param {Number} data.title\r\n * @param {String} data.description\r\n * @param {timestamp} data.date\r\n * @param {Number} data.priority\r\n */\r\nexport function ApiSaveTodoList(data: TodoData) {\r\n  return service.post(\"/api/todo/saveList\", data);\r\n}\r\n\r\n/**\r\n * 获取日程\r\n */\r\nexport function ApiGetTodoDate() {\r\n  return service.get(\"/api/todo/getDateList\");\r\n}\r\n\r\n/**\r\n * 获取待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetTodoList(data) {\r\n  return service.get(\"/api/todo/getList\", data);\r\n}\r\n\r\n/**\r\n * 获取待办详情\r\n * @param {String} id\r\n */\r\nexport function ApiGetTodoDetail(id) {\r\n  return service.get(`/api/todo/getDetail/${id}`);\r\n}\r\n\r\n/**\r\n * 根据日期获取待办数据\r\n * @param {timestamp} day\r\n */\r\nexport function ApiGetTodoListByDay(day) {\r\n  return service.get(\"/api/todo/getListByDay\", {\r\n    day\r\n  });\r\n}\r\n\r\n/**\r\n * 获取本周事件回顾\r\n */\r\nexport function ApiGetReviewTodoList() {\r\n  return service.get(\"/api/todo/getReviewList\");\r\n}\r\n\r\n/**\r\n * 获取已完成待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetFinishedTodoList(data) {\r\n  return service.get(\"/api/todo/getFinishedList\", data);\r\n}\r\n\r\n/**\r\n * 获取回收站待办列表\r\n * @param {Object} data\r\n * @param {Number} data.page\r\n * @param {Number} data.pageSize\r\n */\r\nexport function ApiGetRecycleTodoList(data) {\r\n  return service.get(\"/api/todo/getRecycleList\", data);\r\n}\r\n\r\n/**\r\n * 删除待办\r\n * @param {String} id\r\n */\r\nexport function ApiDeleteTodo(id) {\r\n  return service.delete(`/api/todo/deleteTodo/${id}`);\r\n}\r\n\r\n/**\r\n * 删除待办-回收站\r\n * @param {String} id\r\n */\r\nexport function ApiDeleteTodoToRecycle(id) {\r\n  return service.delete(`/api/todo/deleteToRecycle/${id}`);\r\n}\r\n\r\n/**\r\n * 还原待办-回收站\r\n * @param {String} id\r\n */\r\nexport function ApiRestoreTodoFromRecycle(id) {\r\n  return service.put(`/api/todo/restoreToRecycle/${id}`);\r\n}\r\n\r\n/**\r\n * 切换完成状态\r\n * @param {String} id\r\n */\r\nexport function ApiToggleFinishTodo(id, status) {\r\n  return service.put(`/api/todo/finishTodo`, {\r\n    id,\r\n    status\r\n  });\r\n}\r\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","import styles from \"./index.module.less\";\r\nimport {\r\n  ApiGetTodoListByDay,\r\n  ApiDeleteTodoToRecycle,\r\n  ApiToggleFinishTodo,\r\n  ApiGetTodoDate\r\n} from \"@/api/todo\";\r\nimport { mapState } from \"vuex\";\r\n\r\nexport default {\r\n  name: \"Date\",\r\n  data() {\r\n    return {\r\n      showCalender: false,\r\n      weekDate: [],\r\n      currentDate: +new Date(),\r\n      todoList: [],\r\n      dateList: [],\r\n      loading: false\r\n    };\r\n  },\r\n  methods: {\r\n    formatDate(timeStamp) {\r\n      const weekDate = []; // 日期周期\r\n      let count = 7; // 循环次数\r\n      let day = 0; // 当前天数\r\n      // 获取当前星期几\r\n      const currentDay = this.$moment(timeStamp).day();\r\n      const addNum = timeStamp - 86400000 * currentDay;\r\n      while (count--) {\r\n        const addDay = 86400000 * day; // 当前时间跨度(86400000为一天的间隔)\r\n        weekDate.push(addNum + addDay);\r\n        day++;\r\n      }\r\n      this.weekDate = weekDate;\r\n    },\r\n    formatterCalender(item) {\r\n      const isTodo = this.dateList.some(date =>\r\n        this.$moment(date).isSame(item.date, \"day\")\r\n      );\r\n      if (isTodo) {\r\n        item.bottomInfo = \"待办\";\r\n      }\r\n\r\n      return item;\r\n    },\r\n    async getTodoListByDay() {\r\n      this.loading = true;\r\n      const date = this.$moment(this.currentDate).format(\"YYYY-MM-DD\");\r\n      const resp = await ApiGetTodoListByDay(date);\r\n      this.loading = false;\r\n      if (resp.code === 0) {\r\n        this.todoList = resp.result;\r\n      }\r\n    },\r\n    async handleCheck(item) {\r\n      const { id, status } = item;\r\n      const resp = await ApiToggleFinishTodo(id, status);\r\n      if (resp.code === 0) {\r\n        this.$toast.success(resp.message);\r\n      }\r\n    },\r\n    handleGoDetail(item) {\r\n      this.$router.push({\r\n        name: \"TodoDetail\",\r\n        query: {\r\n          id: item.id\r\n        }\r\n      });\r\n    },\r\n    handleShowCalender() {\r\n      this.showCalender = true;\r\n    },\r\n    handleCloseCalender() {\r\n      this.showCalender = false;\r\n    },\r\n    handleConfirmCalender(value) {\r\n      const times = +new Date(value);\r\n      const date = this.weekDate.find(date =>\r\n        this.$moment(date).isSame(value, \"day\")\r\n      );\r\n      if (!date) {\r\n        this.currentDate = times;\r\n        this.formatDate(times);\r\n      } else {\r\n        this.currentDate = date;\r\n      }\r\n      this.handleCloseCalender();\r\n      this.getTodoListByDay();\r\n    },\r\n    handleUpdateValue(date) {\r\n      this.currentDate = date;\r\n      this.getTodoListByDay();\r\n    },\r\n    async handleDelete(item) {\r\n      const { id } = item;\r\n      const resp = await ApiDeleteTodoToRecycle(id);\r\n      if (resp.code === 0) {\r\n        this.$toast.success(\"删除成功\");\r\n        this.todoList = this.todoList.filter(todo => todo.id !== id);\r\n      }\r\n    },\r\n    async getTodoDate() {\r\n      const resp = await ApiGetTodoDate();\r\n      if (resp.code === 0) {\r\n        this.dateList = resp.result;\r\n      }\r\n    }\r\n  },\r\n  async created() {\r\n    this.loading = true;\r\n    this.formatDate(this.currentDate);\r\n    const times = await this.$store.dispatch(\"getTimes\");\r\n    this.currentDate = times;\r\n    this.formatDate(times);\r\n    this.getTodoListByDay();\r\n    this.getTodoDate();\r\n  },\r\n  render() {\r\n    const {\r\n      showCalender,\r\n      weekDate,\r\n      currentDate,\r\n      todoList,\r\n      loading\r\n    } = this.$data;\r\n\r\n    return (\r\n      <EContainer>\r\n        <EHeader title={this.$route.meta.title} type=\"menu\" />\r\n        <EAside />\r\n        <EContent>\r\n          <EWeekCard\r\n            weekDate={weekDate}\r\n            currentDate={currentDate}\r\n            onUpdateDate={this.handleUpdateValue}\r\n            onShowMore={this.handleShowCalender}\r\n          />\r\n          <van-calendar\r\n            class={styles.calender}\r\n            value={showCalender}\r\n            defaultDate={new Date(currentDate)}\r\n            onInput={this.handleCloseCalender}\r\n            round={false}\r\n            showTitle={false}\r\n            showConfirm={false}\r\n            minDate={new Date(2019, 0, 1)}\r\n            maxDate={new Date(2099, 0, 1)}\r\n            formatter={this.formatterCalender}\r\n            onSelect={this.handleConfirmCalender}\r\n            color=\"#f5222d\"\r\n          />\r\n          <van-divider class=\"divider\">\r\n            {this.$moment(currentDate).isSame(new Date(), \"day\")\r\n              ? \"今日任务\"\r\n              : this.$moment(currentDate).format(\"YYYY-MM-DD\")}\r\n          </van-divider>\r\n          <ETodoCard\r\n            loading={loading}\r\n            todoList={todoList}\r\n            onCheck={this.handleCheck}\r\n            onGoDetail={this.handleGoDetail}\r\n            onDel={this.handleDelete}\r\n          />\r\n        </EContent>\r\n        <EFooter />\r\n      </EContainer>\r\n    );\r\n  }\r\n};\r\n"],"sourceRoot":""}